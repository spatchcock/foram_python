<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>The General Foraminiferal Equation &#8211; Foram modelling</title>
<meta name="description" content="Some maths and code to understand how growth and deficits affect government debt.">
<meta name="keywords" content="python, code">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/">
<meta name="twitter:title" content="The General Foraminiferal Equation">
<meta name="twitter:description" content="Some maths and code to understand how growth and deficits affect government debt.">
<meta name="twitter:creator" content="@spatchcockable">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="The General Foraminiferal Equation">
<meta property="og:description" content="Some maths and code to understand how growth and deficits affect government debt.">
<meta property="og:url" content="/the-general-equation/">
<meta property="og:site_name" content="Foram modelling">





<link rel="canonical" href="/the-general-equation/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Foram modelling Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="/assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="/assets/css/jquery.floating-social-share.min.css">
<link rel="stylesheet" href="/assets/css/ipynb.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Load MathJax-->
<script type="text/x-mathjax-config"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}}); </script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->



<div class="entry-header">
  <div class="header-menu header-menu-top">
    <ul>
      <li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
      <li class="header-item-title">
        <a href="/">
          
          <h2 class="title"> Foram modelling</h2>
        </a>
      </li>
      
        
        

        
          <li class="header-item "><a href="/"><h3>home</h3></a></li>
        
      
      <li class="header-item"><a href="/search"><h3><i class="fa fa-search"></i></h3></a></li>
    </ul>
  </div>
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>The General Foraminiferal Equation</h1>
      
        <h2><span class="entry-date date published updated"><time datetime="2015-07-14T00:00:00+01:00">July 14, 2015</time></span></h2>
      

      
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
          Reading time ~4 minutes
        </p><!-- /.entry-reading-time -->
      
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->


<nav id="menu" style="display: none">
  <ul>
    
      
        <li><a href="/"><h3>home</h3></a></li>
      
    
  </ul>
</nav>


  <a href="https://twitter.com/spatchcockable" class="btn btn-info button-twitter" data-show-count="false" data-size="large"><i class="fa fa-twitter"></i> <span> | Follow @spatchcockable</span></a>



<div id="main" role="main">
  <article class="hentry">
    <div class="entry-content">
      <h1 class="post-title entry-title">The General Foraminiferal Equation</h1>
      <div class="text_cell_render border-box-sizing rendered_html">
<p>The general equation for foraminiferal test accumulation is:</p>
<p><span class="math">\[\frac {\partial C}{\partial t} = D(x)\frac {\partial ^2C}{\partial x^2} - w\frac {\partial C}{\partial x} + a(x)R(x) - \lambda(x) C \hspace{1cm} (1)\]</span></p>
<p>where <span class="math">\(C\)</span> is the concentration of <em>dead</em> tests per unit volume of sediment, <span class="math">\(t\)</span> is time, <span class="math">\(x\)</span> is depth into the sediment, <span class="math">\(D\)</span> is the rate of biodiffusion (mixing, e.g. bioturbation), <span class="math">\(w\)</span> the rate of sedimentation (burial), <span class="math">\(a\)</span> is the concentration of living individuals per unit volume of sediment, <span class="math">\(R\)</span> the rate of population turnover (per unit time) and <span class="math">\(\lambda\)</span> the rate of taphonomic decay (per unit time).</p>
<p>The left hand side of the equation is a <em>partial derivative</em>. It simply describes a <em>rate</em>, specifically the rate at which the concentration of dead foraminiferal tests (<span class="math">\(C\)</span>) changes through time (<span class="math">\(t\)</span>). So the entire equation is describing how fast (and in what direction) the concentration of dead tests are changing. It follows that if we know the number of dead tests that exist at one point in time (which may be zero tests), we can use the equation to predict the number of tests at some later time.</p>
<p>What about the right-hand side? Well, if the left-hand side describes a change in <em>tests per volume of sediment per time</em>, then the right-hand side must describe the same units. And since the right-hand side is comprised of four separate terms, we know that each of them individually must represent a change in <em>tests per volume of sediment per time</em> (because only quantities with identical units can be added to or subtracted from one another). So we can consider the right-hand side as the sum of separate processes each of which result in a particular change to the concentration of dead tests.</p>
<p>We could write,</p>
<p><span class="math">\[\frac {\partial C}{\partial t} = \left(\frac {\partial C}{\partial t}\right)_{mixing} + \left(\frac {\partial C}{\partial t}\right)_{burial} + \left(\frac {\partial C}{\partial t}\right)_{production} + \left(\frac {\partial C}{\partial t}\right)_{loss}\]</span></p>
<p>That's not quite so cryptic is it? The rate at which the concentration of dead tests changes is simply the rates due to test production, taphonomic loss, burial and mixing all added together. And the individual rates are described by the terms in the original equation.</p>
<p><span class="math">\[
\begin{array}{lcl}
\left(\frac {\partial C}{\partial t}\right)_{mixing} &amp;=&amp; \space D(x)\frac {\partial ^2C}{\partial x^2} \\
\left(\frac {\partial C}{\partial t}\right)_{burial} &amp;=&amp;- w\frac {\partial C}{\partial x}\\
\left(\frac {\partial C}{\partial t}\right)_{production} &amp;=&amp; \space a(x)R(x)\\
\left(\frac {\partial C}{\partial t}\right)_{loss} &amp;=&amp; - \lambda(x) C\\
\end{array}
\]</span></p>
<p>We can more or less just mix and match the terms above depending on what precisely we want to model. We'll take a look at each individual term in more detail and model a variety of scenarios in subsequent posts.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-most-general-equation">The <em>most</em> general equation<a class="anchor-link" href="#The-most-general-equation">&#182;</a></h3>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>One other thing worth mentioning: there are two <em>independent</em> variables in the equation above, time (<span class="math">\(t\)</span>) and depth (<span class="math">\(x\)</span>). This means that any evaluation of dead test concentration (<span class="math">\(C\)</span>) is associated with a specific time and a specific depth which allows us to model the dynamics of test accumulation through time and with depth in to the sediment. We can, for example, show how tests accumulate during burial, and we can incorporate variations through time and with depth in things like living populations (e.g. seasonality, infauna) and the rates of population turnover and taphonomic decay.</p>
<p>But the processes described in the model (production, loss, burial, mixing) might vary in other dimensions. For example, populations of foraminifera may vary across space in response to some environmental gradient (e.g. salinity, organics, oxygen). Or perhaps the intensities of bioturbation or taphonomic decay might vary across space, for example if we move from a salt marsh onto a mudflat environment. If we want model such variability then we need to include 2 or 3 spatial dimensions in our model.</p>
<p>So, the equation presented at the start can be further generalised.</p>
<p><span class="math">\[\frac {\partial C(x,y,z,t)}{\partial t} = D(x,y,z,t)\frac {\partial ^2C(x,y,z,t)}{\partial z^2} - w(x,y,t)\frac {\partial C(x,y,z,t)}{\partial z} + a(x,y,z,t)R(x,y,z,t) - \lambda(x,y,z,t) C(x,y,z,t)\]</span></p>
<p>The difference is all those terms in parentheses. In this formulation, <span class="math">\(x\)</span>, <span class="math">\(y\)</span> and <span class="math">\(z\)</span> are the 3 spatial dimensions, while <span class="math">\(t\)</span> is still time. So all this says is that each of the variables might vary in each of these dimensions. In most cases, we will not need to explcitly resolve all of these dimensions, and instead will be content with a 1-dimensional model in space, with or without the time dimension. We refer to equation (1) as <em>The General Equation</em> for most pracical purposes, but with the caveat that it can be generalised further.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id=""><a class="anchor-link" href="#">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Further-reading">Further reading<a class="anchor-link" href="#Further-reading">&#182;</a></h3>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>Berkeley, A., Perry, C.T., Smithers, S.G., Hoon, S., (2014), Towards a formal description of foraminiferal assemblage formation in shallow-water environments: Qualitative and quantitative concepts, <em>Marine Micropaleontology</em>, 112, Pages 27–38.</p>
</div>
      <footer class="entry-meta">
        <span class="entry-tags"><a href="/tags#python" title="Pages tagged python" class="tag"><span class="term">python</span></a><a href="/tags#code" title="Pages tagged code" class="tag"><span class="term">code</span></a></span>
        
        <span class="author vcard"><span class="fn">Andrew Berkeley</span></span>
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=/the-general-equation/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=/the-general-equation/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=/the-general-equation/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->

      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    
  </article>
</div><!-- /#main -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>
<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>





    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'forampython'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2015 Andrew Berkeley. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://github.com/aron-bordin/neo-hpstr-jekyll-theme" rel="nofollow">Neo-HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

</body>
</html>
